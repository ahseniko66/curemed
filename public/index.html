<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CureMed | Medical Routing System</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary-blue: #0d47a1; 
            --dark-blue: #002855; 
            --light-blue: #e3f2fd; 
            --white: #ffffff; 
            --light-gray: #f5f7fa; 
            --medium-gray: #e0e0e0; 
            --dark-gray: #455a64;
            --success-green: #2e7d32;
            --waiting: #ff8f00; 
            --confirmed: #2e7d32; 
            --completed: #1565c0; 
            --cancelled: #c62828;
        }
        
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--light-gray); color: #263238; }
        nav { padding: 18px 50px; background: var(--white); border-bottom: 1px solid var(--medium-gray); display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 32px; font-weight: 700; color: var(--dark-blue); letter-spacing: -0.5px; }
        .main-content { padding: 30px 50px; max-width: 1400px; margin: 0 auto; }
        .card { background: var(--white); padding: 30px; border-radius: 10px; margin-bottom: 25px; border: 1px solid var(--medium-gray); box-shadow: 0 2px 8px rgba(0, 40, 85, 0.08); }
        .card h2 { margin-top: 0; color: var(--dark-blue); font-size: 22px; font-weight: 600; padding-bottom: 18px; border-bottom: 2px solid var(--light-blue); margin-bottom: 25px; }
        input, textarea, select { width: 100%; padding: 14px 16px; margin: 10px 0; border: 1px solid var(--medium-gray); border-radius: 6px; box-sizing: border-box; }
        .btn { background: var(--primary-blue); color: white; border: none; padding: 16px 32px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; }
        .btn:hover { background: var(--dark-blue); transform: translateY(-2px); }
        #map { height: 400px; width: 100%; border-radius: 10px; border: 1px solid var(--medium-gray); margin-top: 20px; }
        
        /* Welcome Section */
        .welcome-section { text-align: left; padding: 80px 50px; background: linear-gradient(135deg, var(--dark-blue) 0%, var(--primary-blue) 100%); color: white; margin-bottom: 50px; position: relative; }
        .welcome-content { display: flex; align-items: center; justify-content: space-between; gap: 60px; max-width: 1400px; margin: 0 auto; }
        .welcome-text { flex: 1; }
        .welcome-image { flex: 0 0 420px; }
        .doctor-image { width: 100%; height: 400px; object-fit: cover; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        
        .grid-2col { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .medical-badge { margin-top: 20px; padding: 20px; background: var(--light-blue); border-radius: 8px; color: var(--dark-blue); border-left: 4px solid var(--primary-blue); display: none; }
        
        @media (max-width: 900px) { .grid-2col { grid-template-columns: 1fr; } .welcome-content { flex-direction: column; text-align: center; } }
    </style>
</head>
<body>

<nav>
    <div class="logo">CureMed</div>
</nav>

<div class="welcome-section">
    <div class="welcome-content">
        <div class="welcome-text">
            <h1>Intelligent Medical Routing System</h1>
            <p>Describe your symptoms for specialized hospital triage in Astana.</p>
        </div>
        <div class="welcome-image">
            <img src="color.png" alt="Doctor" class="doctor-image">
        </div>
    </div>
</div>

<div class="main-content">
    <div class="grid-2col">
        <div class="card">
            <h2>Symptom Assessment</h2>
            <textarea id="symptom-input" rows="4" placeholder="Describe how you feel (e.g., 'I have chest pain and shortness of breath')"></textarea>
            <button class="btn" onclick="analyzeSymptoms()">Analyze & Find Hospital</button>
            
            <div id="ai-badge" class="medical-badge">
                <strong>Recommendation:</strong>
                <div id="diagnosis-content"></div>
            </div>
        </div>

        <div class="card">
            <h2>Hospital Locations - Astana</h2>
            <div id="map"></div>
        </div>
    </div>
</div>

<script>
    const API_URL = "https://curemed-backend.onrender.com/api";

    // 1. ANALYZE SYMPTOMS FUNCTION
    async function analyzeSymptoms() {
        const symptoms = document.getElementById('symptom-input').value;
        const badge = document.getElementById('ai-badge');
        const content = document.getElementById('diagnosis-content');

        if (!symptoms) return alert("Please describe your symptoms first.");

        try {
            const response = await fetch(`${API_URL}/analyze`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ symptoms })
            });
            const data = await response.json();
            
            badge.style.display = 'block';
            content.innerText = data.recommendation || "We recommend visiting the nearest general hospital for evaluation.";
        } catch (err) {
            console.error(err);
            alert("Error connecting to server.");
        }
    }

    // 2. GOOGLE MAPS INIT
    let map;
    function initMap() {
        const astana = { lat: 51.1605, lng: 71.4704 };
        map = new google.maps.Map(document.getElementById("map"), {
            zoom: 12,
            center: astana,
        });

        const hospitals = [
            { name: "City Hospital #1", pos: { lat: 51.1283, lng: 71.4305 } },
            { name: "National Cardiac Center", pos: { lat: 51.1075, lng: 71.4082 } },
            { name: "Mother and Child Center", pos: { lat: 51.1032, lng: 71.4161 } }
        ];

        hospitals.forEach(hosp => {
            new google.maps.Marker({
                position: hosp.pos,
                map: map,
                title: hosp.name
            });
        });
    }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvo8-Lfuzl8OUvbopQaLwiveBMQrdgPj8&callback=initMap" async defer></script>

</body>
</html>
